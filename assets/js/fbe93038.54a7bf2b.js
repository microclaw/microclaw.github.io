"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[1133],{3504(e,s,t){t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>a,frontMatter:()=>d,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"testing","title":"Testing Guide","description":"Unit Tests","source":"@site/docs/testing.md","sourceDirName":".","slug":"/testing","permalink":"/docs/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/microclaw/microclaw/tree/main/docs/testing.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"id":"testing","title":"Testing Guide","sidebar_position":11},"sidebar":"docs","previous":{"title":"Developer Guide","permalink":"/docs/developer-guide"},"next":{"title":"Project Files","permalink":"/docs/project-files"}}');var r=t(4848),i=t(8453);const d={id:"testing",title:"Testing Guide",sidebar_position:11},l=void 0,c={},o=[{value:"Unit Tests",id:"unit-tests",level:2},{value:"Test coverage by module",id:"test-coverage-by-module",level:3},{value:"Manual Testing Checklist",id:"manual-testing-checklist",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Test 1: Basic conversation",id:"test-1-basic-conversation",level:3},{value:"Test 2: Bash tool",id:"test-2-bash-tool",level:3},{value:"Test 3: File write + read",id:"test-3-file-write--read",level:3},{value:"Test 4: File edit",id:"test-4-file-edit",level:3},{value:"Test 5: Glob search",id:"test-5-glob-search",level:3},{value:"Test 6: Grep search",id:"test-6-grep-search",level:3},{value:"Test 7: Web search",id:"test-7-web-search",level:3},{value:"Test 8: Web fetch",id:"test-8-web-fetch",level:3},{value:"Test 9: Memory write + read",id:"test-9-memory-write--read",level:3},{value:"Test 10: Scheduling (cron)",id:"test-10-scheduling-cron",level:3},{value:"Test 11: Scheduling (one-time)",id:"test-11-scheduling-one-time",level:3},{value:"Test 12: Mid-conversation messaging",id:"test-12-mid-conversation-messaging",level:3},{value:"Test 13: Long response splitting",id:"test-13-long-response-splitting",level:3},{value:"Test 14: Group chat (requires group)",id:"test-14-group-chat-requires-group",level:3},{value:"Test 15: Combined workflow",id:"test-15-combined-workflow",level:3},{value:"Database Verification",id:"database-verification",level:2},{value:"Cleanup",id:"cleanup",level:2}];function h(e){const s={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,r.jsx)(s.p,{children:"MicroClaw has 103 unit tests covering all core modules. Run them with:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"cargo test\n"})}),"\n",(0,r.jsx)(s.h3,{id:"test-coverage-by-module",children:"Test coverage by module"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Module"}),(0,r.jsx)(s.th,{children:"Tests"}),(0,r.jsx)(s.th,{children:"What's covered"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"db.rs"})}),(0,r.jsx)(s.td,{children:"13"}),(0,r.jsx)(s.td,{children:"Database creation, chat upsert, message CRUD, ordering, catch-up queries, scheduled task CRUD, status lifecycle"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"memory.rs"})}),(0,r.jsx)(s.td,{children:"8"}),(0,r.jsx)(s.td,{children:"Path construction, read/write global and chat memory, build_memory_context with various states"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"claude.rs"})}),(0,r.jsx)(s.td,{children:"11"}),(0,r.jsx)(s.td,{children:"Serialization/deserialization of all API types, request/response round-trips, client construction"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"config.rs"})}),(0,r.jsx)(s.td,{children:"2"}),(0,r.jsx)(s.td,{children:"Struct cloning, default values"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"error.rs"})}),(0,r.jsx)(s.td,{children:"4"}),(0,r.jsx)(s.td,{children:"Display formatting, From trait conversions, Debug output"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"telegram.rs"})}),(0,r.jsx)(s.td,{children:"10"}),(0,r.jsx)(s.td,{children:"Message merging, trailing/leading assistant removal, system prompt building, response splitting"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/mod.rs"})}),(0,r.jsx)(s.td,{children:"4"}),(0,r.jsx)(s.td,{children:"ToolResult constructors, schema_object helper"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/bash.rs"})}),(0,r.jsx)(s.td,{children:"6"}),(0,r.jsx)(s.td,{children:"Echo, exit codes, stderr, timeout, missing params, definition"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/read_file.rs"})}),(0,r.jsx)(s.td,{children:"4"}),(0,r.jsx)(s.td,{children:"Normal read, offset+limit, file not found, missing params"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/write_file.rs"})}),(0,r.jsx)(s.td,{children:"3"}),(0,r.jsx)(s.td,{children:"Normal write, auto-create dirs, missing params"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/edit_file.rs"})}),(0,r.jsx)(s.td,{children:"5"}),(0,r.jsx)(s.td,{children:"Successful edit, file not found, string not found, multiple matches, missing params"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/glob.rs"})}),(0,r.jsx)(s.td,{children:"3"}),(0,r.jsx)(s.td,{children:"File matching, no matches, missing params"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/grep.rs"})}),(0,r.jsx)(s.td,{children:"7"}),(0,r.jsx)(s.td,{children:"Content matching, no matches, file glob filter, invalid regex, hidden dir skipping"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/memory.rs"})}),(0,r.jsx)(s.td,{children:"7"}),(0,r.jsx)(s.td,{children:"Global/chat read and write, missing params, invalid scope, empty files"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tools/schedule.rs"})}),(0,r.jsx)(s.td,{children:"13"}),(0,r.jsx)(s.td,{children:"cron next_run computation, task creation (cron/once), validation, listing, pause/resume/cancel lifecycle"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"manual-testing-checklist",children:"Manual Testing Checklist"}),"\n",(0,r.jsx)(s.p,{children:"These tests require a running bot with valid credentials."}),"\n",(0,r.jsx)(s.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["A working ",(0,r.jsx)(s.code,{children:".env"})," file with ",(0,r.jsx)(s.code,{children:"TELEGRAM_BOT_TOKEN"}),", ",(0,r.jsx)(s.code,{children:"ANTHROPIC_API_KEY"}),", ",(0,r.jsx)(s.code,{children:"BOT_USERNAME"})]}),"\n",(0,r.jsxs)(s.li,{children:["Bot is running: ",(0,r.jsx)(s.code,{children:"cargo run -- start"})]}),"\n",(0,r.jsx)(s.li,{children:"A Telegram account with a private chat open to the bot"}),"\n",(0,r.jsx)(s.li,{children:"(For group tests) A Telegram group with the bot added as a member"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"test-1-basic-conversation",children:"Test 1: Basic conversation"}),"\n",(0,r.jsx)(s.p,{children:"Send a simple message in private chat."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Hello, what can you do?\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Bot responds with a description of its capabilities. Typing indicator should appear while processing."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-2-bash-tool",children:"Test 2: Bash tool"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Run `echo hello world` in bash\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': Bot returns "hello world".']}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Run `ls -la /tmp` and tell me the total file count\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Bot executes ls, counts files, and reports."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-3-file-write--read",children:"Test 3: File write + read"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: Create a file /tmp/microclaw_test.txt with the content "MicroClaw test file"\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': "Successfully wrote to /tmp/microclaw_test.txt"']}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Read the file /tmp/microclaw_test.txt\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Displays file content with line numbers."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-4-file-edit",children:"Test 4: File edit"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: In /tmp/microclaw_test.txt, change "test file" to "works great"\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': "Successfully edited /tmp/microclaw_test.txt". Verify with:']}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Read /tmp/microclaw_test.txt\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': "MicroClaw works great"']}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-5-glob-search",children:"Test 5: Glob search"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Find all .toml files in the current project directory\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Lists ",(0,r.jsx)(s.code,{children:"Cargo.toml"})," and any other .toml files."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-6-grep-search",children:"Test 6: Grep search"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: Search for "fn main" in all .rs files in the src directory\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Returns matching lines with file paths and line numbers."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-7-web-search",children:"Test 7: Web search"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: Search the web for "Rust programming language"\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Returns numbered results with titles, URLs, and snippets from DuckDuckGo."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-8-web-fetch",children:"Test 8: Web fetch"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Fetch https://httpbin.org/get and show me the result\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Returns the JSON response from httpbin."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-9-memory-write--read",children:"Test 9: Memory write + read"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Remember that my favorite color is blue\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Bot confirms it saved to memory."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: What is my favorite color?\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': Bot answers "blue" (from memory).']}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-10-scheduling-cron",children:"Test 10: Scheduling (cron)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: Schedule a task to say "Ping from scheduler!" every 2 minutes\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': "Task #N scheduled. Next run: ..."']}),"\n",(0,r.jsx)(s.p,{children:"Wait 2 minutes."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': Bot sends "Ping from scheduler!" (or similar) automatically.']}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: List my scheduled tasks\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Shows the active task."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Cancel task #N\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': "Task #N cancelled."']}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-11-scheduling-one-time",children:"Test 11: Scheduling (one-time)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: At [timestamp 3 minutes from now], send me "One-shot works!"\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Task is created and fires once at the specified time, then marked completed."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-12-mid-conversation-messaging",children:"Test 12: Mid-conversation messaging"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Create 5 different files in /tmp named microclaw_1.txt through microclaw_5.txt with incrementing numbers as content, and tell me when you're done with each one\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),': Bot may send intermediate "progress" messages via ',(0,r.jsx)(s.code,{children:"send_message"})," during the multi-step operation."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-13-long-response-splitting",children:"Test 13: Long response splitting"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"You: Write a 5000-character essay about the history of computing\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Response arrives in multiple Telegram messages (split at ~4096 char boundaries)."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-14-group-chat-requires-group",children:"Test 14: Group chat (requires group)"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Add the bot to a Telegram group"}),"\n",(0,r.jsx)(s.li,{children:"Send several messages from different users without @mentioning the bot"}),"\n",(0,r.jsxs)(s.li,{children:["Then: ",(0,r.jsx)(s.code,{children:"@yourbotname summarize the conversation"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Bot reads all messages since its last reply and provides a summary."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"test-15-combined-workflow",children:"Test 15: Combined workflow"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'You: Search the web for "Rust error handling best practices", fetch the first result, and save a one-sentence summary to your memory\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected"}),": Bot chains web_search -> web_fetch -> write_memory -> responds with the summary."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"database-verification",children:"Database Verification"}),"\n",(0,r.jsx)(s.p,{children:"After running tests, verify data was stored correctly:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:'sqlite3 data/microclaw.db "SELECT COUNT(*) FROM messages;"\nsqlite3 data/microclaw.db "SELECT * FROM scheduled_tasks;"\nsqlite3 data/microclaw.db "SELECT * FROM chats;"\n'})}),"\n",(0,r.jsx)(s.h2,{id:"cleanup",children:"Cleanup"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"rm -f /tmp/microclaw_test.txt /tmp/microclaw_*.txt\nsqlite3 data/microclaw.db \"UPDATE scheduled_tasks SET status='cancelled' WHERE status='active';\"\n"})})]})}function a(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453(e,s,t){t.d(s,{R:()=>d,x:()=>l});var n=t(6540);const r={},i=n.createContext(r);function d(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);